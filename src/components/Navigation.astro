---
// Clean and optimized Navigation component
---

<nav class="fixed top-0 left-0 right-0 bg-white/90 backdrop-blur-md border-b border-gray-200/60 z-50 transition-all duration-300 shadow-sm" id="navbar">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16 lg:h-18">
      
      <!-- Logo -->
      <a href="#hero" class="flex items-center group transition-transform duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-lg p-2 -m-2" aria-label="Przejdź do strony głównej">
        <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center mr-3 shadow-md group-hover:shadow-lg transition-shadow duration-200">
          <span class="text-white font-bold text-base">AD</span>
        </div>
        <div class="flex flex-col">
          <span class="font-bold text-gray-900 text-lg group-hover:text-blue-600 transition-colors duration-200">Adrian</span>
          <span class="text-xs text-gray-600 font-medium group-hover:text-blue-500 transition-colors duration-200">Frontend Developer</span>
        </div>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center space-x-1">
        <a href="#about" class="nav-link group px-4 py-2 rounded-lg text-gray-700 hover:text-blue-600 hover:bg-blue-50 font-medium transition-all duration-200 flex items-center gap-2" aria-label="Przejdź do sekcji O mnie">
          <div class="w-4 h-4 rounded bg-blue-100 group-hover:bg-blue-200 flex items-center justify-center transition-colors duration-200">
            <svg class="w-2.5 h-2.5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
          </div>
          <span>O mnie</span>
        </a>
        
        <a href="#services" class="nav-link group px-4 py-2 rounded-lg text-gray-700 hover:text-emerald-600 hover:bg-emerald-50 font-medium transition-all duration-200 flex items-center gap-2" aria-label="Przejdź do sekcji Usługi">
          <div class="w-4 h-4 rounded bg-emerald-100 group-hover:bg-emerald-200 flex items-center justify-center transition-colors duration-200">
            <svg class="w-2.5 h-2.5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
            </svg>
          </div>
          <span>Usługi</span>
        </a>
        
        <a href="#projects" class="nav-link group px-4 py-2 rounded-lg text-gray-700 hover:text-purple-600 hover:bg-purple-50 font-medium transition-all duration-200 flex items-center gap-2" aria-label="Przejdź do sekcji Portfolio">
          <div class="w-4 h-4 rounded bg-purple-100 group-hover:bg-purple-200 flex items-center justify-center transition-colors duration-200">
            <svg class="w-2.5 h-2.5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2H5a2 2 0 00-2 2v2M7 7h10"/>
            </svg>
          </div>
          <span>Portfolio</span>
        </a>
        
        <!-- Separator -->
        <div class="h-6 w-px bg-gray-300 mx-3"></div>
        
        <!-- CTA Button -->
        <a href="#contact" class="group relative bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 text-white px-8 py-3 rounded-xl font-bold transition-all duration-400 hover:shadow-xl hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-500/50 focus:ring-offset-2 flex items-center gap-3 overflow-hidden" aria-label="Rozpocznij współpracę">
          <!-- Animated background -->
          <div class="absolute inset-0 bg-gradient-to-r from-blue-700 via-indigo-700 to-purple-700 opacity-0 group-hover:opacity-100 transition-opacity duration-400"></div>
          
          <!-- Shimmer effect -->
          <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/25 to-transparent scale-x-0 group-hover:scale-x-100 origin-left transition-transform duration-600 ease-out skew-x-12"></div>
          
          <div class="relative z-10 flex items-center gap-2">
            <svg class="w-5 h-5 transition-all duration-400 group-hover:scale-110 group-hover:rotate-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
            </svg>
            <span class="font-bold tracking-wide group-hover:tracking-wider transition-all duration-300">Kontakt</span>
            <svg class="w-4 h-4 transition-all duration-400 group-hover:translate-x-1 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 5l7 7-7 7"/>
            </svg>
          </div>
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <div class="lg:hidden">
        <button id="mobile-menu-button" class="group relative text-gray-700 hover:text-blue-600 focus:outline-none focus:ring-4 focus:ring-blue-500/50 focus:ring-offset-2 rounded-xl p-3 transition-all duration-300 hover:bg-blue-50 active:scale-95" aria-label="Toggle menu nawigacji" aria-expanded="false">
          <!-- Background pulse effect -->
          <div class="absolute inset-0 bg-blue-100 rounded-xl scale-0 group-hover:scale-100 group-focus:scale-100 transition-transform duration-300 opacity-50"></div>
          
          <svg id="menu-icon" class="relative z-10 w-6 h-6 transition-all duration-300 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
          <svg id="close-icon" class="absolute inset-3 w-6 h-6 z-10 transition-all duration-300 opacity-0 rotate-180 group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"/>
          </svg>
          
          <!-- Ripple effect -->
          <div class="absolute inset-0 rounded-xl border-2 border-blue-300 scale-100 group-active:scale-125 opacity-0 group-active:opacity-100 transition-all duration-200"></div>
        </button>
      </div>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="lg:hidden hidden">
      <div class="absolute left-0 right-0 top-full bg-white/95 backdrop-blur-md border-b border-gray-200 shadow-lg">
        <div class="px-4 py-6 space-y-3">
          <a href="#about" class="mobile-nav-link px-4 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 font-medium rounded-lg transition-all duration-200 flex items-center gap-3" aria-label="Przejdź do sekcji O mnie">
            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
              <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
              </svg>
            </div>
            <div>
              <div class="font-medium">O mnie</div>
              <div class="text-sm text-gray-500">Poznaj mnie bliżej</div>
            </div>
          </a>
          
          <a href="#services" class="mobile-nav-link px-4 py-3 text-gray-700 hover:text-emerald-600 hover:bg-emerald-50 font-medium rounded-lg transition-all duration-200 flex items-center gap-3" aria-label="Przejdź do sekcji Usługi">
            <div class="w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center">
              <svg class="w-4 h-4 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
              </svg>
            </div>
            <div>
              <div class="font-medium">Usługi</div>
              <div class="text-sm text-gray-500">Co oferuję</div>
            </div>
          </a>
          
          <a href="#projects" class="mobile-nav-link px-4 py-3 text-gray-700 hover:text-purple-600 hover:bg-purple-50 font-medium rounded-lg transition-all duration-200 flex items-center gap-3" aria-label="Przejdź do sekcji Portfolio">
            <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
              <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2H5a2 2 0 00-2 2v2M7 7h10"/>
              </svg>
            </div>
            <div>
              <div class="font-medium">Portfolio</div>
              <div class="text-sm text-gray-500">Moje realizacje</div>
            </div>
          </a>
          
          <!-- Mobile CTA -->
          <div class="pt-3 mt-3 border-t border-gray-200">
            <a href="#contact" class="mobile-nav-link bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-3 rounded-lg font-semibold transition-all duration-200 hover:shadow-lg flex items-center gap-3" aria-label="Rozpocznij współpracę">
              <div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                </svg>
              </div>
              <div>
                <div class="font-semibold">Porozmawiajmy</div>
                <div class="text-sm text-blue-100">Bezpłatna konsultacja</div>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<style>
  html {
    scroll-padding-top: 5rem;
    scroll-behavior: smooth;
  }

  /* Navbar scroll effects */
  .navbar-scrolled {
    background-color: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    border-bottom-color: rgba(0, 0, 0, 0.1) !important;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
  }

  /* Active states */
  .nav-link.active {
    background-color: var(--active-bg, rgb(239 246 255)) !important;
    color: var(--active-color, rgb(37 99 235)) !important;
  }

  .nav-link.active[href="#about"] {
    --active-bg: rgb(239 246 255);
    --active-color: rgb(37 99 235);
  }

  .nav-link.active[href="#services"] {
    --active-bg: rgb(236 253 245);
    --active-color: rgb(5 150 105);
  }

  .nav-link.active[href="#projects"] {
    --active-bg: rgb(250 245 255);
    --active-color: rgb(147 51 234);
  }

  /* Mobile menu animations */
  #mobile-menu {
    transform: translateY(-10px);
    opacity: 0;
    transition: all 0.2s ease-out;
  }

  #mobile-menu:not(.hidden) {
    transform: translateY(0);
    opacity: 1;
  }

  /* Mobile menu button animations */
  #mobile-menu-button[aria-expanded="true"] #menu-icon {
    opacity: 0;
    transform: rotate(90deg);
  }

  #mobile-menu-button[aria-expanded="true"] #close-icon {
    opacity: 1;
    transform: rotate(0deg);
  }

  /* Mobile nav link animations */
  .mobile-nav-link {
    transform: translateX(-20px);
    opacity: 0;
    animation: slideIn 0.3s ease-out forwards;
  }

  .mobile-nav-link:nth-child(1) { animation-delay: 0.05s; }
  .mobile-nav-link:nth-child(2) { animation-delay: 0.1s; }
  .mobile-nav-link:nth-child(3) { animation-delay: 0.15s; }
  .mobile-nav-link:nth-child(5) { animation-delay: 0.2s; }

  @keyframes slideIn {
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  /* Accessibility improvements */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
    
    html {
      scroll-behavior: auto;
    }
  }

  /* High contrast mode */
  @media (prefers-contrast: high) {
    .nav-link,
    .mobile-nav-link {
      border: 1px solid currentColor;
    }
  }

  /* Focus improvements */
  .nav-link:focus-visible,
  .mobile-nav-link:focus-visible {
    outline: 2px solid rgb(59 130 246);
    outline-offset: 2px;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const navbar = document.getElementById('navbar');
    const navLinks = document.querySelectorAll('.nav-link');
    
    // Mobile menu toggle
    if (mobileMenuButton && mobileMenu) {
      mobileMenuButton.addEventListener('click', function() {
        const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
        
        if (isExpanded) {
          closeMobileMenu();
        } else {
          openMobileMenu();
        }
      });
    }
    
    function openMobileMenu() {
      mobileMenu?.classList.remove('hidden');
      mobileMenuButton?.setAttribute('aria-expanded', 'true');
      document.body.style.overflow = 'hidden';
      
      // Focus first link
      setTimeout(() => {
        const firstLink = mobileMenu?.querySelector('.mobile-nav-link') as HTMLElement;
        firstLink?.focus();
      }, 100);
    }
    
    function closeMobileMenu() {
      mobileMenu?.classList.add('hidden');
      mobileMenuButton?.setAttribute('aria-expanded', 'false');
      document.body.style.overflow = '';
      mobileMenuButton?.focus();
    }
    
    // Close mobile menu on link click
    document.querySelectorAll('.mobile-nav-link').forEach(link => {
      link.addEventListener('click', () => {
        setTimeout(closeMobileMenu, 150);
      });
    });
    
    // Close mobile menu on escape
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && !mobileMenu?.classList.contains('hidden')) {
        closeMobileMenu();
      }
    });
    
    // Navbar scroll effects
    let lastScrollY = window.scrollY;
    
    function updateNavbar() {
      const currentScrollY = window.scrollY;
      
      if (navbar) {
        if (currentScrollY > 50) {
          navbar.classList.add('navbar-scrolled');
        } else {
          navbar.classList.remove('navbar-scrolled');
        }
      }
      
      lastScrollY = currentScrollY;
    }
    
    window.addEventListener('scroll', updateNavbar, { passive: true });
    
    // Active section highlighting
    const sections = Array.from(document.querySelectorAll('section[id]'));
    const navLinkMap = new Map();
    navLinks.forEach(link => {
      const href = link.getAttribute('href');
      if (href?.startsWith('#')) {
        const sectionId = href.substring(1);
        navLinkMap.set(sectionId, link);
      }
    });

    // Helper: aktywuj link na podstawie id
    function setActiveLink(sectionId: string) {
      navLinks.forEach(link => link.classList.remove('active'));
      const navLink = navLinkMap.get(sectionId);
      navLink?.classList.add('active');
    }

    // IntersectionObserver
    let lastActiveId: string | null = null;
    const observerOptions = {
      root: null,
      rootMargin: '0px 0px -60% 0px', // lepsza detekcja górnej sekcji
      threshold: 0.3
    };
    const sectionObserver = new IntersectionObserver((entries) => {
      let maxRatio = 0;
      let activeId = null;
      entries.forEach(entry => {
        if (entry.isIntersecting && entry.intersectionRatio > maxRatio) {
          maxRatio = entry.intersectionRatio;
          activeId = entry.target.id;
        }
      });
      if (activeId && activeId !== lastActiveId) {
        setActiveLink(activeId);
        lastActiveId = activeId;
      }
    }, observerOptions);
    sections.forEach(section => sectionObserver.observe(section));

    // Fallback: scroll event (jeśli observer nie zadziała)
    function fallbackActiveLink() {
      let scrollPos = window.scrollY + (navbar?.offsetHeight || 64) + 40;
      let currentId = sections[0]?.id;
      for (let i = 0; i < sections.length; i++) {
        const el = sections[i] as HTMLElement;
        if (el.offsetTop <= scrollPos) {
          currentId = el.id;
        }
      }
      if (currentId) setActiveLink(currentId);
    }
    window.addEventListener('scroll', fallbackActiveLink, { passive: true });
    // Wywołaj na starcie
    fallbackActiveLink();
    
    // Smooth scroll for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      const anchorElement = anchor as HTMLAnchorElement;
      anchorElement.addEventListener('click', function(e) {
        e.preventDefault();
        const href = anchorElement.getAttribute('href');
        if (href && href !== '#') {
          const target = document.getElementById(href.substring(1));
          if (target) {
            const navbarHeight = navbar?.offsetHeight || 64;
            const offsetTop = target.offsetTop - navbarHeight - 20;
            
            window.scrollTo({
              top: offsetTop,
              behavior: 'smooth'
            });
            
            if (history.pushState) {
              history.pushState(null, '', href);
            }
          }
        }
      });
    });
    
    // Initial setup
    updateNavbar();
    
    // Handle initial hash
    if (window.location.hash) {
      setTimeout(() => {
        const target = document.getElementById(window.location.hash.substring(1));
        if (target) {
          const navbarHeight = navbar?.offsetHeight || 64;
          const offsetTop = target.offsetTop - navbarHeight - 20;
          window.scrollTo({ top: offsetTop, behavior: 'smooth' });
        }
      }, 100);
    }
  });
</script>
